<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>충전하기</title>
  <link rel="stylesheet" th:href="@{/css/money/creditCharge.css}">
</head>
<body>
<div class="container">
  <h2>충전하시겠습니까?</h2>

  <div class="amount-section">
    <p>금액</p>
    <div class="amount-options">
      <div class="amount-box" data-credit="1000">1,000크래딧<br>+ 100포인트</div>
      <div class="amount-box" data-credit="5000">5,000크래딧<br>+ 500포인트</div>
      <div class="amount-box" data-credit="10000">10,000크래딧<br>+ 1,000포인트</div>
      <div class="amount-box" data-credit="30000">30,000크래딧<br>+ 3,000포인트</div>
    </div>
  </div>

  <div class="button-group">
    <button class="confirm-btn">확인</button>
    <button class="cancel-btn">취소</button>
  </div>
</div>

<script>
  let selectedCredit = null;

  document.querySelectorAll('.amount-box').forEach(box => {
    box.addEventListener('click', function() {
      document.querySelectorAll('.amount-box').forEach(b => b.classList.remove('selected'));
      this.classList.add('selected');
      selectedCredit = this.getAttribute('data-credit');
      console.log(selectedCredit);
    });
  });

  document.querySelector('.confirm-btn').addEventListener('click', function() {
    if (!selectedCredit) {
      alert('금액을 선택해주세요.');
      return;
    }

    fetch('/money/creditCharge', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(selectedCredit)
    })
    .then(response => {
      if (!response.ok) throw new Error('결제 요청 실패');
      return response.json();
    })
    .then(data => {
      location.href = data.result.redirectUrl;
    })
    .catch(error => {
      alert('에러 발생: ' + error.message);
    });
  });

  document.querySelector('.cancel-btn').addEventListener('click', function() {
    alert('결제가 취소되었습니다.');
  });
</script>
</body>
</html>
