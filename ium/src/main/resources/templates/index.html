<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>μ΄μν„° - λ©”μΈνμ΄μ§€</title>
    <link rel="stylesheet" th:href="@{/css/index.css}">
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">
</head>
<body>
    <!-- Header -->
    <div th:replace="header :: header"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Search Section -->
        <section class="search-section">
            <h1 class="search-title">μ΄μν„°</h1>
            <p class="search-subtitle">λ‹Ήμ‹ μ μ¬λ¥μ΄ μ—°κ²°λλ” μ‹μ‘μ </p>
            
            <div class="search-and-buttons">
                <div class="search-container">
                    <input type="text" class="search-input" placeholder="μ›ν•λ” μ„λΉ„μ¤λ¥Ό κ²€μƒ‰ν•΄λ³΄μ„Έμ”" th:value="${currentSearch}">
                    <button class="search-button">π”</button>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn primary" onclick="redirectToRequestForm()">μλΆ°ν•κΈ°</button>
                    <button class="action-btn" onclick="redirectToAIMatching()">AI λ§¤μΉ­</button>
                </div>
            </div>
        </section>

        <!-- Category Section -->
        <section class="category-section">
            <div class="category-buttons">
                <button class="category-btn" th:classappend="${currentCategory == 'all'} ? 'active' : ''" data-category="all" onclick="filterByCategory('all')">
                    μ „μ²΄
                </button>
                <button class="category-btn" th:classappend="${currentCategory == 'design'} ? 'active' : ''" data-category="design" onclick="filterByCategory('design')">
                    λ””μμΈ
                </button>
                <button class="category-btn" th:classappend="${currentCategory == 'programming'} ? 'active' : ''" data-category="programming" onclick="filterByCategory('programming')">
                    ν”„λ΅κ·Έλλ°
                </button>
                <button class="category-btn" th:classappend="${currentCategory == 'video'} ? 'active' : ''" data-category="video" onclick="filterByCategory('video')">
                    μμƒνΈμ§‘
                </button>
                <button class="category-btn" th:classappend="${currentCategory == 'legal'} ? 'active' : ''" data-category="legal" onclick="filterByCategory('legal')">
                    μ„Έλ¬΄/<br>λ²•λ¬΄/<br>λ…Έλ¬΄
                </button>
                <button class="category-btn" th:classappend="${currentCategory == 'translation'} ? 'active' : ''" data-category="translation" onclick="filterByCategory('translation')">
                    λ²μ—­/<br>ν†µμ—­
                </button>
            </div>
        </section>

        <!-- Request Section -->
        <section class="request-section">
            <h2 class="section-title">μλΆ° λ©λ΅</h2>

            <div class="request-grid" id="requestGrid">
                <div class="request-card" th:each="request : ${workRequests}" 
                     th:data-request-id="${request.id}"
                     th:data-category="${request.category}"
                     th:data-budget="${request.price}"
                     th:onclick="'window.location.href=\'/workrequest/\' + ' + ${request.id}">
                    <div class="request-image">
                        <img th:src="${request.fileUrl != null ? request.fileUrl : 'https://via.placeholder.com/150x100/E6F6DC/000000?text=' + (request.category != null ? request.category : 'μλΆ°')}" 
                             th:alt="${request.title}" 
                             onerror="this.src='https://via.placeholder.com/150x100/E6F6DC/000000?text=μλΆ°'">
                    </div>
                    <div class="request-content">
                        <h3 class="request-title" th:text="${request.title}">μ λ©</h3>
                        <p class="request-description" th:text="${#strings.abbreviate(request.content, 100)}">μ„¤λ…</p>
                        <div class="request-footer">
                            <span class="request-price" th:text="${#numbers.formatDecimal(request.price, 0, 'COMMA', 0, 'POINT')} + 'μ›~'">κ°€κ²©</span>
                            <span class="request-author" th:text="${request.createdBy != null ? request.createdBy : 'μµλ…'}">μ‘μ„±μ</span>
                        </div>
                        <!-- AD ν¬μΈνΈκ°€ λ†’μ€ κ²½μ° λ±ƒμ§€ ν‘μ‹ -->
                        <div th:if="${request.adPoint > 500}" class="ad-badge">
                            <span class="ad-text">AD</span>
                        </div>
                    </div>
                </div>
                
                <!-- μλΆ°κ°€ μ—†λ” κ²½μ° -->
                <div th:if="${#lists.isEmpty(workRequests)}" class="no-requests">
                    <p>ν„μ¬ μ΅°κ±΄μ— λ§λ” μλΆ°κ°€ μ—†μµλ‹λ‹¤.</p>
                    <button class="action-btn primary" onclick="filterByCategory('all')">μ „μ²΄ λ³΄κΈ°</button>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <div th:replace="footer :: footer"></div>

    <script th:src="@{/js/index.js}"></script>
    <script th:src="@{/js/header.js}"></script>
    <script th:inline="javascript">
        // μ„λ²„μ—μ„ μ „λ‹¬λ ν„μ¬ μΉ΄ν…κ³ λ¦¬μ™€ κ²€μƒ‰μ–΄
        var currentCategory = /*[[${currentCategory}]]*/ 'all';
        var currentSearch = /*[[${currentSearch}]]*/ '';
    </script>
</body>
</html>